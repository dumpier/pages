<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>年金・保険・税金の計算</title>
    <link href="./res/default.css" rel="stylesheet">
    <script src="./res/config.js"></script>
	<script src="../../res/js/my.js"></script>
</head>
<body>
    <div id="app">
        <div id="mask" class="mask" v-show="isShowMask"><div class="loader"></div></div>
        <h1>個人事業主の税金計算(vue.js版)</h1>
        <span class="ml-10" v-html="changeMode"></span>
        <div id="content" v-html="template"></div>
    </div>
</body>

<template id="tax-table">
    <div class="column">
        <table class="table border">
            <thead>
                <tr><th colspan=2 class="diagonal">{usage}</th><th>月間(万円)</th><th>年間(万円)</th></tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</template>


<script type="importmap">
{
    "imports": {
        "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js"
    }
}
</script>

<script type="module">
import { createApp, ref } from 'vue';
const mode = {
    0:"composition",
    1:"options",
    current:()=>{ return myjs.req.get("mode")==1 ? 1:0; },
    next:()=>{ return mode.current()==0 ? 1:0; },
    isCompositionApi:()=>{ return mode.current()==0 ? true : false; },
    isOptionsApi:()=>{ return !mode.isCompositionApi(); },
    switch:()=>{
        let current_mode = mode[mode.current()];
        let next_mode = mode[mode.next()];
        let base_url = myjs.req.base();
        return `Now in ${mode[mode.current()]} api mode, switch to <a href="${base_url}?mode=${mode.next()}">${mode[mode.next()]} api</a> mode`;
    },
};
const option = {};
// CompositionとOptions APIの共通オプション
option.common = {
    created() {
        this.isShowMask = false;
        this.changeMode = mode.switch();
    },
    mounted() {},
    methods:{},
};

option.composition = Object.assign({}, option.common);
option.options = Object.assign({}, option.common);

option.composition.setup = function () {
    console.log("Vue is composition api mode");
    const isShowMask = ref(true);
    const template = config.template;
    const changeMode = "";
    return {
        isShowMask,
        template,
        changeMode,
    }
};

option.options.data = function () {
    console.log("Vue is options api mode");
    return {
        isShowMask:true,
        template:config.template,
        changeMode:"",
    }
};


option.current = mode.isOptionsApi() ? option.options : option.composition;
const app = createApp(option.current);
app.mount('#app');
</script>

</html>